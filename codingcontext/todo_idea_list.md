# HyDE-Planner 개선 계획: "인사이트 도출 엔진"으로의 진화 (v2)

이 문서는 반도체 전문가의 피드백을 반영하여, HyDE-Planner를 **전문가를 위한 정량적 인사이트 도출 엔진**으로 발전시키기 위한 구체적인 개발 계획을 정리한 To-Do 리스트입니다.

---

### **Part 1: 전문가 수준의 정량 분석 능력 강화**

-   **[ ] 1.1. 전문가용 분석 도구 세트(Expert Toolset) 개발**
    -   **목표:** 일반 웹 검색을 넘어, 신뢰도 높은 정형/비정형 데이터 소스에 직접 접근하고 계산하는 능력을 확보합니다.
    -   **세부 실행안:**
        -   **[ ] `financial_data_search` 도구 개발:**
            -   SEC EDGAR API 또는 유사 금융 API와 연동.
            -   기업의 재무제표(10-K, 10-Q)에서 특정 항목(예: 매출, 영업이익, R&D 비용)을 직접 추출하는 기능 구현.
        -   **[ ] `market_data_search` 도구 개발:**
            -   Google 검색의 `site:` 파라미터를 활용하여 Gartner, IDC 등 특정 시장조사기관 웹사이트를 타겟팅하는 검색 기능 구현.
        -   **[ ] `patent_search` 도구 개발:**
            -   Google Patents API 또는 유사 서비스를 연동하여, 특정 키워드에 대한 특허 출원 동향, 주요 출원인 정보 등을 추출하는 기능 구현.
        -   **[ ] `calculation_tools` 확장:**
            -   기존 아이디어 구체화: `calculate_cagr` (연평균 성장률), `calculate_profit_margin` (이익률) 등 재무 분석에 필수적인 계산 함수 추가.

-   **[ ] 1.2. LLM 페르소나(Persona) 강화**
    -   **목표:** LLM의 응답 톤앤매너와 분석 깊이를 전문가 수준으로 끌어올립니다.
    -   **세부 실행안:**
        -   **[ ] 모든 핵심 프롬프트(`prompts.py`) 수정:**
            -   시스템 프롬프트에 "You are a senior semiconductor industry analyst at a top-tier consulting firm..." 과 같이 구체적이고 전문적인 역할을 부여하는 지시문 추가.
            -   가설 생성, 계획 수립, 최종 종합 등 모든 단계에서 해당 페르소나를 일관되게 유지하도록 요구.

---

### **Part 2: 결과물의 혁신: 컨설팅 보고서 자동 생성**

-   **[ ] 2.1. 최종 답변 프롬프트(`get_verification_and_synthesis_prompt`) 재설계**
    -   **목표:** 단순 텍스트 요약을 넘어, 의사결정에 즉시 활용 가능한 구조화된 컨설팅 보고서를 생성합니다.
    -   **세부 실행안:**
        -   **[ ] 프롬프트에 새로운 출력 구조 강제:**
            -   `Executive Summary (BLUF)`: 핵심 결론을 서두에 제시.
            -   `Key Quantitative Findings`: 핵심 수치/예측을 글머리 기호로 요약.
            -   `Data Tables`: 모든 수치 데이터를 마크다운 테이블 형식으로 정리.
            -   `Chart Data`: 차트 생성이 용이한 JSON 형식(예: `{"type": "bar", "labels": [...], "data": [...]}`)으로 데이터 제공.
            -   `Risks and Assumptions`: 분석의 기반이 된 가정과 잠재적 리스크를 명시.

---

### **Part 3: 사용자 경험의 혁신: 상호작용과 제어**

-   **[ ] 3.1. 상호작용형 "What-If" 시나리오 분석 기능 구현**
    -   **목표:** 사용자가 핵심 변수를 직접 변경하며 결과를 탐색할 수 있는 동적인 분석 환경을 제공합니다.
    -   **세부 실행안:**
        -   **[ ] Streamlit UI에 "What-If 분석" 모드 추가:**
            -   기본 쿼리 외에, 변경할 변수와 값을 입력받는 필드 추가 (예: 변수: `원자재 가격`, 변경: `10% 상승`).
        -   **[ ] `run_what_if_analysis.py` (또는 유사 모듈) 신규 개발:**
            -   1. Baseline 분석 실행 → 2. 사용자 변수를 `calculation_tools`에 적용하여 재계산 → 3. 두 시나리오의 결과를 비교 분석하는 보고서 생성.
        -   **[ ] 최종 결과물에 대화형 프롬프트 추가:**
            -   분석 결과 출력 후, "[결과에 만족하십니까? 아니면 다른 What-If 분석을 진행하시겠습니까?]" 와 같은 후속 질문을 제시하여 상호작용을 유도.

-   **[ ] 3.2. 사용자 주도 심층 분석 (Source-Type Selection) 기능 구현**
    -   **목표:** 사용자가 분석에 사용할 정보 소스의 종류를 직접 선택하여 결과의 깊이와 관점을 제어할 수 있도록 합니다.
    -   **세부 실행안:**
        -   **[ ] Streamlit UI에 "문서 유형 우선순위" 옵션 추가:**
            -   `[ ] 재무 보고서 (10-K, 10-Q)`, `[ ] 시장 분석 보고서`, `[ ] 기술 논문/특허`, `[ ] 최신 뉴스` 등 멀티셀렉트 박스 제공.
        -   **[ ] `phase_3_execute_plan_and_verify` 로직 수정:**
            -   사용자가 선택한 문서 유형에 따라 검색 쿼리를 동적으로 수정.
            -   (예: '재무 보고서' 선택 시, `google_search` 쿼리에 `filetype:pdf OR site:sec.gov` 와 같은 파라미터를 추가).

---

### **Part 4: 기존 기능 및 시스템 가치 증명 (기존 아이디어 구체화)**

-   **[ ] 4.1. Raw LLM 결과와 직접 비교 기능 구현**
    -   **세부 실행안:**
        -   **[ ]** Streamlit UI에 "Compare with Raw LLM" 옵션 추가.
        -   **[ ]** 옵션 선택 시, HyDE-Planner의 **컨설팅 보고서**와 Raw LLM의 **일반 텍스트 답변**을 `st.columns`를 이용해 나란히 비교 표시.

-   **[ ] 4.2. "개선점" 자동 분석 및 설명 기능 구현**
    -   **세부 실행안:**
        -   **[ ]** `get_justify_improvement_prompt` 프롬프트를 "인사이트 도출 엔진" 컨셉에 맞게 수정.
        -   **[ ]** "HyDE-Planner는 `financial_data_search` 도구를 사용하여 10-K 보고서에서 실제 감가상각비 '$5B'를 추출했지만, Raw LLM은 이를 알 수 없어 '비용 증가'라는 추상적인 표현에 그쳤습니다." 와 같이, **사용한 전문 도구와 그 결과**를 명확히 비교하여 설명하도록 유도.
